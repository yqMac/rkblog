(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{512:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("系列文章")]),t._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/blogs/docs/back-end/python/SpiderDemo1.html"}},[t._v("python爬取花瓣网图片-初探茅庐")])],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/blogs/docs/back-end/python/SpiderDemo2.html"}},[t._v("python爬取花瓣网图片-渐入佳境")])],1)])]),t._v(" "),a("h2",{attrs:{id:"添加要使用的包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加要使用的包"}},[t._v("#")]),t._v(" 添加要使用的包")]),t._v(" "),a("p",[a("code",[t._v("requests")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("pip3 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" requests\n")])])]),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/8yjGad.png",alt:""}})]),t._v(" "),a("p",[a("code",[t._v("BeautifulSoup")])]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("pip3 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" bs4\n")])])]),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/8yjbJ1.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"新建工程-导入相关包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建工程-导入相关包"}},[t._v("#")]),t._v(" 新建工程 导入相关包")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bs4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" BeautifulSoup\n")])])]),a("p",[t._v("导入相关包运行后提示如下图所示的ModuleNotFound错误，是由于环境配置问题导致。"),a("br"),t._v("见"),a("RouterLink",{attrs:{to:"/blogs/docs/back-end/python/spider.html#解决modulenotfound错误"}},[t._v("ModuleNotFound错误")]),t._v(" "),a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/8yxP74.png",alt:""}})],1),t._v(" "),a("h2",{attrs:{id:"查看网页结构-定位爬取元素位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看网页结构-定位爬取元素位置"}},[t._v("#")]),t._v(" 查看网页结构，定位爬取元素位置")]),t._v(" "),a("p",[a("code",[t._v("右键 -> 查看网页源代码")]),t._v("，通过定位可以看到，要爬取的图片链接位于"),a("code",[t._v('class="img x layer-view loaded"')]),t._v("\n的"),a("code",[t._v("a")]),t._v("标签下的"),a("code",[t._v("img")]),t._v("子标签，图片链接为"),a("code",[t._v("img")]),t._v("标签的"),a("code",[t._v("src")]),t._v("属性；图片的名字为"),a("code",[t._v("a")]),t._v("标签同级的"),a("code",[t._v("p")]),t._v("标签的内容")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/86p2KP.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"获取页面信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取页面信息"}},[t._v("#")]),t._v(" 获取页面信息")]),t._v(" "),a("p",[t._v("定义请求头（可通过页面控制台复制）")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义请求头")]),t._v("\nheaders "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accept"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*/*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accept-encoding"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gzip, deflate, br"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accept-language"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zh-CN,zh;q=0.9"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cache-control"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"no-cache"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"origin: https"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//huaban.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pragma"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"no-cache"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"referer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https//huaban.com/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sec-fetch-dest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"empty"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sec-fetch-mode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cors"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sec-fetch-site"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-site"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user-agent"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x-client-data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CJG2yQEIpbbJAQjBtskBCKmdygEInqDKAQjQr8oBCLywygEIl7XKAQjttcoBCI66ygEImb3KAQjOvcoB"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("定义要爬取的url")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义url")]),t._v("\nurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://huaban.com/explore/dianyinghaibao'")]),t._v("\n")])])]),a("p",[t._v("获取页面信息")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 爬取过程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("craw")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    soup "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" BeautifulSoup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lxml'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("soup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prettify"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 调用")]),t._v("\ncraw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("执行后会获取到网页的源代码")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/86AFsA.png",alt:""}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("如果报错如下所示，找不到'lxml'解析器的时候，通过"),a("code",[t._v("pip3 install lxml")]),t._v("安装解决\n"),a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/86FVOI.png",alt:""}})])]),t._v(" "),a("h2",{attrs:{id:"获取图片链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取图片链接"}},[t._v("#")]),t._v(" 获取图片链接")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取图片链接")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" pic_href "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" soup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" class_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img x layer-view loaded'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pic_href"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("通过预想的获取指定class的a标签获取图片相关信息的时候，发现并不能正确的获取到相关结果。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/20/86muKe.png",alt:""}})]),t._v(" "),a("p",[t._v("经过我仔细的分析（和baidu）之后发现，图片数据不是一开始直接加载到页面中的，而是通过异步请求获取数据后渲染到页面上。\n所以对花瓣网的第一次爬取失败了 😦")]),t._v(" "),a("h2",{attrs:{id:"modulenotfound错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modulenotfound错误"}},[t._v("#")]),t._v(" ModuleNotFound错误 "),a("Badge",{attrs:{text:"解决方案"}})],1),t._v(" "),a("p",[t._v("查看"),a("code",[t._v("Preferences -> Project -> Project Interpreter")]),t._v("，此时只会存在一个环境信息。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/8yzwM6.png",alt:""}})]),t._v(" "),a("p",[t._v("点击齿轮，选择"),a("code",[t._v("Add Local")]),t._v("，弹出窗口后，选择"),a("code",[t._v("System Interpreter")]),t._v("选项，挑选合适版本的py进行引入，确认。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/8yzXQ0.png",alt:""}})]),t._v(" "),a("p",[t._v("再次运行程序，无异常。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/19/86St0S.png",alt:""}})])])}),[],!1,null,null,null);s.default=e.exports}}]);